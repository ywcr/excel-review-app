<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡æ„ä»£ç æµ‹è¯•</title>
</head>
<body>
    <h1>é‡æ„ä»£ç æµ‹è¯•</h1>
    <div id="test-results"></div>
    
    <script>
        // æ¨¡æ‹ŸCONFIGå¯¹è±¡
        const CONFIG = {
            questionnaireTypes: {
                xihuang_consumer: {
                    name: "è¥¿é»„æ¶ˆè´¹è€…é—®å·",
                    contactType: "æ¶ˆè´¹è€…",
                    hasChannel: true,
                    apiEndpoint: "/lgb/xfzwj/add"
                }
            }
        };
    </script>
    
    <!-- å¼•å…¥é‡æ„åçš„æ¨¡å— -->
    <script src="js/automation/questionnaire-logic/base-questionnaire.js"></script>
    <script src="js/automation/questionnaire-logic/xihuang-questionnaire.js"></script>
    <script src="js/automation/template-manager.js"></script>
    <script src="js/automation/validation-manager.js"></script>
    <script src="js/automation/execution-logic.js"></script>
    <script src="js/automation/control-panel.js"></script>
    <script src="js/automation/code-generator.js"></script>
    
    <script>
        function runTests() {
            const results = document.getElementById('test-results');
            let testResults = [];
            
            try {
                // æµ‹è¯•1: åŸºç¡€é—®å·ç±»
                console.log('æµ‹è¯•1: åŸºç¡€é—®å·ç±»');
                const baseQuestionnaire = new BaseQuestionnaire({
                    name: "æµ‹è¯•é—®å·",
                    contactType: "æ¶ˆè´¹è€…",
                    hasChannel: true
                });
                testResults.push('âœ… åŸºç¡€é—®å·ç±»åˆ›å»ºæˆåŠŸ');
                
                // æµ‹è¯•2: é—®å·é€»è¾‘å·¥å‚
                console.log('æµ‹è¯•2: é—®å·é€»è¾‘å·¥å‚');
                const xihuangLogic = QuestionnaireLogicFactory.create("è¥¿é»„æ¶ˆè´¹è€…é—®å·");
                testResults.push('âœ… è¥¿é»„é—®å·é€»è¾‘åˆ›å»ºæˆåŠŸ');
                
                // æµ‹è¯•3: æ¨¡æ¿ç®¡ç†å™¨
                console.log('æµ‹è¯•3: æ¨¡æ¿ç®¡ç†å™¨');
                const templateManager = new TemplateManager();
                const domTemplate = templateManager.getTemplate('dom_single');
                testResults.push('âœ… æ¨¡æ¿ç®¡ç†å™¨å·¥ä½œæ­£å¸¸');
                
                // æµ‹è¯•4: éªŒè¯ç®¡ç†å™¨
                console.log('æµ‹è¯•4: éªŒè¯ç®¡ç†å™¨');
                const validationManager = new ValidationManager();
                const validationCode = validationManager.getValidationCode();
                testResults.push('âœ… éªŒè¯ç®¡ç†å™¨å·¥ä½œæ­£å¸¸');
                
                // æµ‹è¯•5: æ‰§è¡Œé€»è¾‘ç®¡ç†å™¨
                console.log('æµ‹è¯•5: æ‰§è¡Œé€»è¾‘ç®¡ç†å™¨');
                const executionLogicManager = new ExecutionLogicManager();
                const domLogic = executionLogicManager.getDomExecutionLogic();
                testResults.push('âœ… æ‰§è¡Œé€»è¾‘ç®¡ç†å™¨å·¥ä½œæ­£å¸¸');
                
                // æµ‹è¯•6: æ§åˆ¶é¢æ¿ç®¡ç†å™¨
                console.log('æµ‹è¯•6: æ§åˆ¶é¢æ¿ç®¡ç†å™¨');
                const controlPanelManager = new ControlPanelManager();
                const panelCode = controlPanelManager.getControlPanelCode();
                testResults.push('âœ… æ§åˆ¶é¢æ¿ç®¡ç†å™¨å·¥ä½œæ­£å¸¸');
                
                // æµ‹è¯•7: æ ¸å¿ƒä»£ç ç”Ÿæˆå™¨
                console.log('æµ‹è¯•7: æ ¸å¿ƒä»£ç ç”Ÿæˆå™¨');
                const generator = new AutomationCodeGenerator(CONFIG.questionnaireTypes.xihuang_consumer);
                
                // æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
                const testData = [
                    { name: "å¼ ä¸‰", sex: "ç”·", time: "09.01", assignee: "æµ‹è¯•å‘˜" }
                ];
                
                const code = generator.generateCode(testData, "æµ‹è¯•å‘˜", "09.01", false);
                testResults.push('âœ… æ ¸å¿ƒä»£ç ç”Ÿæˆå™¨å·¥ä½œæ­£å¸¸');
                
                testResults.push('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼é‡æ„æˆåŠŸï¼');
                
            } catch (error) {
                testResults.push(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`);
                console.error('æµ‹è¯•é”™è¯¯:', error);
            }
            
            results.innerHTML = testResults.map(result => `<p>${result}</p>`).join('');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        window.addEventListener('load', runTests);
    </script>
</body>
</html>
