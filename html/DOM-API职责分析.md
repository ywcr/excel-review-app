# DOM vs API æ¨¡å¼èŒè´£åˆ†æ

## âœ… èŒè´£åˆ†ç¦»è‰¯å¥½çš„åœ°æ–¹

### 1. **æ‰§è¡Œæ–¹å¼å®Œå…¨åˆ†ç¦»**
- **DOMæ¨¡å¼**: é€šè¿‡æµè§ˆå™¨é¡µé¢æ“ä½œ
  ```javascript
  setInputValue('å§“å', name);           // è®¾ç½®è¡¨å•å­—æ®µ
  setOptionValue(i, answer);            // é€‰æ‹©é€‰é¡¹
  submitBtn.click();                    // ç‚¹å‡»æäº¤æŒ‰é’®
  ```

- **APIæ¨¡å¼**: ç›´æ¥HTTPè¯·æ±‚
  ```javascript
  const response = await fetch(`${API_BASE_URL}${config.apiEndpoint}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(requestData)
  });
  ```

### 2. **å‡½æ•°å‘½ååŒºåˆ†**
- DOM: `start()`, `automatic()`, `createTask()`
- API: `startApi()`, `automaticApi()`, `createTaskApi()`

### 3. **é…ç½®åˆ†ç¦»**
- DOMæ¨¡å¼éœ€è¦: `contentWindow`, é¡µé¢å…ƒç´ é€‰æ‹©å™¨
- APIæ¨¡å¼éœ€è¦: `API_BASE_URL`, ç­¾åç®—æ³•, ç«¯ç‚¹é…ç½®

## ğŸ”´ å­˜åœ¨å†²çªçš„åœ°æ–¹

### 1. **å…±äº«çŠ¶æ€å˜é‡** âš ï¸
```javascript
let currentIndex = 0;  // ä¸¤ç§æ¨¡å¼å…±äº«
let isRunning = false; // ä¸¤ç§æ¨¡å¼å…±äº«
```
**é—®é¢˜**: å¦‚æœç”¨æˆ·åŒæ—¶ä½¿ç”¨DOMå’ŒAPIæ¨¡å¼ä¼šäº§ç”ŸçŠ¶æ€å†²çª

### 2. **ç›¸åŒçš„é—®é¢˜ç­”æ¡ˆé€»è¾‘**
```javascript
// ä¸¤ç§æ¨¡å¼éƒ½è°ƒç”¨ç›¸åŒçš„ç­”æ¡ˆå‡½æ•°
for (let i = 0; i < 10; i++) {
    const answerFunc = window[`_answer${i}`];
    const answer = answerFunc();
    // åªæ˜¯ä½¿ç”¨æ–¹å¼ä¸åŒ
}
```
**å½±å“**: è¿™ä¸ªå…¶å®æ˜¯åˆç†çš„ï¼Œå› ä¸ºç­”æ¡ˆé€»è¾‘åº”è¯¥ä¸€è‡´

### 3. **éªŒè¯åŠŸèƒ½å…±äº«**
ä¸¤ç§æ¨¡å¼éƒ½ä½¿ç”¨ç›¸åŒçš„ `validateData()` å‡½æ•°ï¼Œè¿™æ˜¯åˆç†çš„ã€‚

## ğŸ’¡ æ”¹è¿›å»ºè®®

### 1. **çŠ¶æ€åˆ†ç¦»** (å·²åˆ›å»ºè§£å†³æ–¹æ¡ˆ)
åˆ›å»ºäº† `ExecutionStateManager` æ¥åˆ†ç¦»çŠ¶æ€ï¼š
```javascript
const domState = { currentIndex: 0, isRunning: false };
const apiState = { currentIndex: 0, isRunning: false };
```

### 2. **äº’æ–¥æ‰§è¡Œæ£€æŸ¥**
```javascript
function canStartExecution(mode) {
    const status = getExecutionStatus();
    if (status.anyRunning) {
        console.log(`âš ï¸ ${mode}æ¨¡å¼æ— æ³•å¯åŠ¨ï¼Œå¦ä¸€æ¨¡å¼æ­£åœ¨è¿è¡Œä¸­`);
        return false;
    }
    return true;
}
```

## ğŸ“‹ éœ€è¦è¡¥å……çš„é—®å·é€»è¾‘

æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œéœ€è¦è¡¥å……ä»¥ä¸‹4ä¸ªé—®å·çš„å…·ä½“é€»è¾‘ï¼š

### 1. **ç‰›è§£æ¶ˆè´¹è€…é—®å·** (niujie-questionnaire.js)
- çŠ¶æ€: âŒ åªæœ‰å ä½ç¬¦
- é…ç½®: âœ… å·²å®Œæ•´é…ç½®
- éœ€è¦: å…·ä½“çš„ç­”é¢˜é€»è¾‘å‡½æ•°

### 2. **çŸ¥æŸæ¶ˆè´¹è€…é—®å·** (zhibai-questionnaire.js)  
- çŠ¶æ€: âŒ åªæœ‰å ä½ç¬¦
- é…ç½®: âœ… å·²å®Œæ•´é…ç½®
- éœ€è¦: å…·ä½“çš„ç­”é¢˜é€»è¾‘å‡½æ•°

### 3. **å…­å‘³æ‚£è€…é—®å·** (liuwei-questionnaire.js)
- çŠ¶æ€: âŒ åªæœ‰å ä½ç¬¦  
- é…ç½®: âœ… å·²å®Œæ•´é…ç½®
- éœ€è¦: å…·ä½“çš„ç­”é¢˜é€»è¾‘å‡½æ•°

### 4. **è´´è†æ‚£è€…é—®å·** (tiegao-questionnaire.js)
- çŠ¶æ€: âŒ åªæœ‰å ä½ç¬¦
- é…ç½®: âœ… å·²å®Œæ•´é…ç½®  
- éœ€è¦: å…·ä½“çš„ç­”é¢˜é€»è¾‘å‡½æ•°

### 5. **è¥¿é»„æ¶ˆè´¹è€…é—®å·** (xihuang-questionnaire.js)
- çŠ¶æ€: âœ… å·²å®Œæ•´å®ç°
- åŒ…å«: 10ä¸ªé—®é¢˜çš„å…·ä½“ç­”é¢˜é€»è¾‘

## ğŸ¯ é—®å·é€»è¾‘å®ç°æ¨¡æ¿

æ¯ä¸ªé—®å·éœ€è¦å®ç°çš„æ ‡å‡†æ ¼å¼ï¼š
```javascript
class XxxQuestionnaire extends BaseQuestionnaire {
    getQuestionLogic() {
        return `
// ==================== XXXé—®å·ç­”é¢˜é€»è¾‘ ====================

${this.getRandomAnswerFunctions()}

// 1ã€é—®é¢˜1
function _answer0() {
    const option = ['é€‰é¡¹1', 'é€‰é¡¹2', 'é€‰é¡¹3'];
    const index = random(0, option.length - 1);
    return option[index];
}

// 2ã€é—®é¢˜2  
function _answer1() {
    // å…·ä½“é€»è¾‘
}

// ... æ›´å¤šé—®é¢˜
`;
    }
}
```

## ğŸ”§ æ€»ç»“

### DOMå’ŒAPIèŒè´£åˆ†ç¦»æƒ…å†µï¼š
- âœ… **æ‰§è¡Œæ–¹å¼å®Œå…¨åˆ†ç¦»** - æ— å†²çª
- âœ… **å‡½æ•°å‘½ååŒºåˆ†** - æ— å†²çª  
- âœ… **é…ç½®åˆ†ç¦»** - æ— å†²çª
- âš ï¸ **çŠ¶æ€ç®¡ç†å…±äº«** - å­˜åœ¨æ½œåœ¨å†²çªï¼Œå·²æä¾›è§£å†³æ–¹æ¡ˆ
- âœ… **ç­”æ¡ˆé€»è¾‘å…±äº«** - åˆç†çš„å…±äº«

### éœ€è¦è¡¥å……çš„å†…å®¹ï¼š
1. **ç«‹å³éœ€è¦**: 4ä¸ªé—®å·ç±»å‹çš„å…·ä½“ç­”é¢˜é€»è¾‘
2. **å»ºè®®æ”¹è¿›**: çŠ¶æ€ç®¡ç†åˆ†ç¦»ï¼ˆå¯é€‰ï¼‰
3. **é•¿æœŸä¼˜åŒ–**: æ‰§è¡Œæ¨¡å¼äº’æ–¥æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰

**ç»“è®º**: å½“å‰çš„èŒè´£åˆ†ç¦»åŸºæœ¬åˆç†ï¼Œä¸»è¦é—®é¢˜æ˜¯ç¼ºå°‘å…·ä½“çš„é—®å·é€»è¾‘å®ç°ã€‚
